<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Finanza Plus</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 10px 10px 80px 10px;
            min-height: 100vh;
            overflow-y: auto;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            color: white;
            margin-bottom: 20px;
            position: relative;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .language-selector {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }

        .lang-btn {
            padding: 8px 12px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .lang-btn.active {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.6);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-tabs {
            display: flex;
            overflow-x: auto;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            position: sticky;
            top: 10px;
            z-index: 100;
        }

        .nav-tab {
            flex: 1;
            min-width: 120px;
            padding: 12px 8px;
            text-align: center;
            background: transparent;
            border: none;
            color: rgba(255,255,255,0.8);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            white-space: nowrap;
        }

        .nav-tab.active {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255,255,255,0.1);
        }

        .calculator {
            display: none;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease-in;
            margin-bottom: 20px;
            min-height: auto;
            overflow-y: visible;
        }

        .calculator.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .calc-title {
            text-align: center;
            margin-bottom: 25px;
            color: #4a5568;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2d3748;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-1px);
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        /* Nuevo estilo para la fila de conversi√≥n con bot√≥n de intercambio */
        .conversion-row {
            display: flex;
            align-items: end;
            gap: 10px;
            margin-bottom: 20px;
        }

        .conversion-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .swap-btn {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .swap-btn:hover {
            transform: translateY(-2px) rotate(180deg);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .swap-btn:active {
            transform: translateY(0) rotate(180deg);
        }

        .btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .result {
            margin-top: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
            border-left: 4px solid #667eea;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .result.show {
            display: block;
        }

        .result h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            color: #4a5568;
            font-weight: 500;
        }

        .result-value {
            color: #2d3748;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .conversion-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .conversion-item {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .conversion-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .conversion-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .conversion-unit {
            font-size: 0.9rem;
            color: #4a5568;
        }

        .tip-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .tip-btn {
            padding: 12px 8px;
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid #667eea;
            border-radius: 8px;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tip-btn:hover, .tip-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
        }

        .currency-symbol {
            font-size: 1.3rem;
            color: #667eea;
            margin-right: 5px;
        }

        @media (max-width: 480px) {
            .nav-tabs {
                padding: 3px;
                position: sticky;
                top: 5px;
            }
            
            .nav-tab {
                font-size: 0.8rem;
                padding: 10px 6px;
                min-width: 100px;
            }
            
            .calculator {
                padding: 20px;
                margin-bottom: 30px;
            }
            
            .container {
                padding: 5px 10px 100px 10px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .form-row .form-group {
                margin-bottom: 20px;
            }

            .conversion-row {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .conversion-row .form-group {
                margin-bottom: 15px;
            }

            .swap-btn {
                width: 100%;
                height: 45px;
                border-radius: 12px;
                margin-bottom: 0;
            }
            
            .conversion-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .tip-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .header {
                padding: 15px 0;
                position: sticky;
                top: 0;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                z-index: 50;
                margin-bottom: 10px;
            }
            
            .result {
                margin-bottom: 30px;
            }

            .language-selector {
                position: relative;
                top: auto;
                right: auto;
                justify-content: center;
                margin-bottom: 10px;
            }

            .lang-btn {
                font-size: 0.8rem;
                padding: 6px 10px;
            }
        }

        .footer {
            text-align: center;
            padding: 30px 20px;
            color: rgba(255,255,255,0.8);
            margin-top: 40px;
        }

        .amortization-table {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            border-radius: 10px;
            background: white;
        }

        .amortization-table table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .amortization-table th,
        .amortization-table td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
        }

        .amortization-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        .amortization-table td {
            background: white;
        }

        .amortization-table tr:hover td {
            background: #f7fafc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="language-selector">
                <button class="lang-btn active" onclick="cambiarIdioma('es')">üá™üá∏ ES</button>
                <button class="lang-btn" onclick="cambiarIdioma('en')">üá∫üá∏ EN</button>
                <button class="lang-btn" onclick="cambiarIdioma('de')">üá©üá™ DE</button>
            </div>
            <h1 data-i18n="title">üßÆ Finanza Plus</h1>
            <p data-i18n="subtitle">Herramientas financieras y de conversi√≥n</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" data-calc="hipoteca">
                <span data-i18n="nav.mortgage">üè† Hipoteca</span>
            </button>
            <button class="nav-tab" data-calc="impuestos">
                <span data-i18n="nav.taxes">üí∞ Impuestos</span>
            </button>
            <button class="nav-tab" data-calc="propinas">
                <span data-i18n="nav.tips">üçΩÔ∏è Propinas</span>
            </button>
            <button class="nav-tab" data-calc="conversion">
                <span data-i18n="nav.conversion">üìê Conversi√≥n</span>
            </button>
        </div>

        <!-- Calculadora de Hipoteca -->
        <div class="calculator active" id="calc-hipoteca">
            <h2 class="calc-title" data-i18n="mortgage.title">Calculadora de Hipoteca</h2>
            <div class="form-group">
                <label for="precio-casa" data-i18n="mortgage.house_price">üíµ Precio de la casa</label>
                <input type="number" id="precio-casa" data-i18n-placeholder="mortgage.house_price_placeholder" placeholder="300000" value="300000">
            </div>
            <div class="form-group">
                <label for="enganche" data-i18n="mortgage.down_payment">üí≥ Enganche (%)</label>
                <input type="number" id="enganche" placeholder="20" value="20" min="0" max="100">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="tasa-interes" data-i18n="mortgage.interest_rate">üìà Tasa de inter√©s (%)</label>
                    <input type="number" id="tasa-interes" placeholder="3.5" value="3.5" step="0.1">
                </div>
                <div class="form-group">
                    <label for="anos-prestamo" data-i18n="mortgage.loan_years">üìÖ A√±os del pr√©stamo</label>
                    <select id="anos-prestamo">
                        <option value="15" data-i18n="mortgage.years_15">15 a√±os</option>
                        <option value="20" data-i18n="mortgage.years_20">20 a√±os</option>
                        <option value="30" data-i18n="mortgage.years_30" selected>30 a√±os</option>
                    </select>
                </div>
            </div>
            <button class="btn" onclick="calcularHipoteca()" data-i18n="mortgage.calculate">Calcular Hipoteca</button>
            
            <div class="result" id="resultado-hipoteca">
                <h3 data-i18n="mortgage.summary">Resumen de tu Hipoteca</h3>
                <div class="result-item">
                    <span class="result-label" data-i18n="mortgage.loan_amount">Monto del pr√©stamo:</span>
                    <span class="result-value" id="monto-prestamo">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="mortgage.monthly_payment">Pago mensual:</span>
                    <span class="result-value" id="pago-mensual">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="mortgage.total_interest">Total de intereses:</span>
                    <span class="result-value" id="total-intereses">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="mortgage.total_payment">Total a pagar:</span>
                    <span class="result-value" id="total-pagar">$0</span>
                </div>
                
                <div class="amortization-table" id="tabla-amortizacion" style="display: none;">
                    <h4 style="margin: 15px 0 10px 0; color: #4a5568;" data-i18n="mortgage.amortization_table">Tabla de Amortizaci√≥n (Primeros 12 meses)</h4>
                    <table id="amortization-table">
                        <thead>
                            <tr>
                                <th data-i18n="mortgage.month">Mes</th>
                                <th data-i18n="mortgage.payment">Pago</th>
                                <th data-i18n="mortgage.principal">Principal</th>
                                <th data-i18n="mortgage.interest">Inter√©s</th>
                                <th data-i18n="mortgage.balance">Balance</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                
                <button class="btn" onclick="toggleAmortization()" id="btn-amortization" data-i18n="mortgage.show_table">Ver Tabla de Amortizaci√≥n</button>
            </div>
        </div>

        <!-- Calculadora de Impuestos -->
        <div class="calculator" id="calc-impuestos">
            <h2 class="calc-title" data-i18n="taxes.title">Calculadora de Impuestos</h2>
            <div class="form-group">
                <label for="salario-bruto" data-i18n="taxes.gross_salary">üíº Salario bruto anual</label>
                <input type="number" id="salario-bruto" placeholder="50000" value="50000">
            </div>
            <div class="form-group">
                <label for="estado-civil" data-i18n="taxes.marital_status">üë´ Estado civil</label>
                <select id="estado-civil">
                    <option value="soltero" data-i18n="taxes.single">Soltero</option>
                    <option value="casado" data-i18n="taxes.married">Casado</option>
                    <option value="jefe-familia" data-i18n="taxes.head_of_household">Jefe de familia</option>
                </select>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="dependientes" data-i18n="taxes.dependents">üë∂ Dependientes</label>
                    <input type="number" id="dependientes" placeholder="0" value="0" min="0">
                </div>
                <div class="form-group">
                    <label for="deducciones" data-i18n="taxes.extra_deductions">üìù Deducciones extra</label>
                    <input type="number" id="deducciones" placeholder="0" value="0">
                </div>
            </div>
            
            <!-- Secci√≥n de porcentajes personalizables -->
            <div style="background: rgba(102, 126, 234, 0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                <h3 style="color: #4a5568; margin-bottom: 15px; font-size: 1.1rem;" data-i18n="taxes.configure_rates">‚öôÔ∏è Configurar Porcentajes de Impuestos</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="tasa-federal" data-i18n="taxes.federal_tax">üèõÔ∏è Impuesto Federal (%)</label>
                        <input type="number" id="tasa-federal" placeholder="22" value="22" min="0" max="50" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="tasa-estatal" data-i18n="taxes.state_tax">üè¢ Impuesto Estatal (%)</label>
                        <input type="number" id="tasa-estatal" placeholder="5" value="5" min="0" max="15" step="0.1">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="tasa-seguro-social" data-i18n="taxes.social_security">üë• Seguro Social (%)</label>
                        <input type="number" id="tasa-seguro-social" placeholder="6.2" value="6.2" min="0" max="10" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="tasa-medicare" data-i18n="taxes.medicare">üè• Medicare (%)</label>
                        <input type="number" id="tasa-medicare" placeholder="1.45" value="1.45" min="0" max="5" step="0.05">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="tasa-desempleo" data-i18n="taxes.unemployment">üíº Seguro Desempleo (%)</label>
                        <input type="number" id="tasa-desempleo" placeholder="0.5" value="0.5" min="0" max="3" step="0.1">
                    </div>
                    <div class="form-group">
                        <label for="otras-deducciones" data-i18n="taxes.other_deductions">üìã Otras Deducciones (%)</label>
                        <input type="number" id="otras-deducciones" placeholder="0" value="0" min="0" max="10" step="0.1">
                    </div>
                </div>
                
                <div class="tip-buttons" style="margin-top: 15px;">
                    <button class="tip-btn" onclick="cargarPerfilImpuestos('basico')" style="grid-column: span 2;" data-i18n="taxes.basic_profile">üìä Perfil B√°sico</button>
                    <button class="tip-btn" onclick="cargarPerfilImpuestos('alto')" style="grid-column: span 2;" data-i18n="taxes.high_income">üí∞ Ingresos Altos</button>
                    <button class="tip-btn" onclick="cargarPerfilImpuestos('california')" style="grid-column: span 2;" data-i18n="taxes.california">üå¥ California</button>
                </div>
            </div>
            
            <button class="btn" onclick="calcularImpuestos()" data-i18n="taxes.calculate">Calcular Impuestos</button>
            
            <div class="result" id="resultado-impuestos">
                <h3 data-i18n="taxes.detailed_calculation">C√°lculo de Impuestos Detallado</h3>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.gross_annual_salary">Salario bruto anual:</span>
                    <span class="result-value" id="salario-bruto-display">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.total_deductions">Deducciones totales:</span>
                    <span class="result-value" id="deducciones-totales">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.taxable_income">Ingreso gravable:</span>
                    <span class="result-value" id="ingreso-gravable">$0</span>
                </div>
                
                <!-- Desglose detallado -->
                <div style="background: #f7fafc; padding: 15px; border-radius: 10px; margin: 15px 0;">
                    <h4 style="color: #4a5568; margin-bottom: 10px;" data-i18n="taxes.tax_breakdown">üìä Desglose de Impuestos</h4>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.federal_tax">Impuesto federal</span> (<span id="tasa-federal-display">22</span>%):</span>
                        <span class="result-value" id="impuesto-federal">$0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.state_tax">Impuesto estatal</span> (<span id="tasa-estatal-display">5</span>%):</span>
                        <span class="result-value" id="impuesto-estatal">$0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.social_security">Seguro Social</span> (<span id="tasa-ss-display">6.2</span>%):</span>
                        <span class="result-value" id="seguro-social">$0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.medicare">Medicare</span> (<span id="tasa-medicare-display">1.45</span>%):</span>
                        <span class="result-value" id="medicare">$0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.unemployment">Seguro Desempleo</span> (<span id="tasa-desempleo-display">0.5</span>%):</span>
                        <span class="result-value" id="seguro-desempleo">$0</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label"><span data-i18n="taxes.other_deductions">Otras deducciones</span> (<span id="tasa-otras-display">0</span>%):</span>
                        <span class="result-value" id="otras-deducciones-monto">$0</span>
                    </div>
                </div>
                
                <div class="result-item" style="border-top: 2px solid #667eea; padding-top: 15px;">
                    <span class="result-label" data-i18n="taxes.total_taxes">Total de impuestos:</span>
                    <span class="result-value" id="total-impuestos">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.net_annual_salary">Salario neto anual:</span>
                    <span class="result-value" id="salario-neto">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.net_monthly_salary">Salario neto mensual:</span>
                    <span class="result-value" id="salario-mensual">$0</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="taxes.net_weekly_salary">Salario neto semanal:</span>
                    <span class="result-value" id="salario-semanal">$0</span>
                </div>
                
                <!-- Gr√°fico visual de porcentajes -->
                <div style="background: white; padding: 15px; border-radius: 10px; margin: 15px 0;">
                    <h4 style="color: #4a5568; margin-bottom: 10px;" data-i18n="taxes.salary_distribution">üìà Distribuci√≥n del Salario</h4>
                    <div id="grafico-impuestos" style="margin: 10px 0;">
                        <!-- Se llena din√°micamente -->
                    </div>
                    <div class="result-item">
                        <span class="result-label" data-i18n="taxes.effective_tax_rate">Tasa efectiva de impuestos:</span>
                        <span class="result-value" id="tasa-efectiva">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calculadora de Propinas -->
        <div class="calculator" id="calc-propinas">
            <h2 class="calc-title" data-i18n="tips.title">Calculadora de Propinas</h2>
            <div class="form-group">
                <label for="total-cuenta" data-i18n="tips.bill_total">üßæ Total de la cuenta</label>
                <input type="number" id="total-cuenta" placeholder="100.00" value="100" step="0.01">
            </div>
            <div class="form-group">
                <label for="porcentaje-propina" data-i18n="tips.tip_percentage">üí° Porcentaje de propina</label>
                <input type="number" id="porcentaje-propina" placeholder="15" value="15" min="0" max="50" step="0.5">
            </div>
            
            <div class="tip-buttons">
                <button class="tip-btn" onclick="setPropina(10)">10%</button>
                <button class="tip-btn" onclick="setPropina(15)">15%</button>
                <button class="tip-btn" onclick="setPropina(18)">18%</button>
                <button class="tip-btn" onclick="setPropina(20)">20%</button>
                <button class="tip-btn" onclick="setPropina(22)">22%</button>
                <button class="tip-btn" onclick="setPropina(25)">25%</button>
            </div>
            
            <div class="form-group">
                <label for="num-personas" data-i18n="tips.number_of_people">üë• N√∫mero de personas</label>
                <input type="number" id="num-personas" placeholder="1" value="1" min="1">
            </div>
            
            <button class="btn" onclick="calcularPropina()" data-i18n="tips.calculate">Calcular Propina</button>
            
            <div class="result" id="resultado-propina">
                <h3 data-i18n="tips.calculation">C√°lculo de Propina</h3>
                <div class="result-item">
                    <span class="result-label" data-i18n="tips.tip_amount">Monto de propina:</span>
                    <span class="result-value" id="monto-propina">$0.00</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="tips.total_to_pay">Total a pagar:</span>
                    <span class="result-value" id="total-con-propina">$0.00</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="tips.per_person">Por persona:</span>
                    <span class="result-value" id="por-persona">$0.00</span>
                </div>
                <div class="result-item">
                    <span class="result-label" data-i18n="tips.tip_per_person">Propina por persona:</span>
                    <span class="result-value" id="propina-persona">$0.00</span>
                </div>
            </div>
        </div>

        <!-- Calculadora de Conversi√≥n -->
        <div class="calculator" id="calc-conversion">
            <h2 class="calc-title" data-i18n="conversion.title">Conversor de Unidades</h2>
            <div class="form-group">
                <label for="tipo-conversion" data-i18n="conversion.conversion_type">üìè Tipo de conversi√≥n</label>
                <select id="tipo-conversion" onchange="cambiarTipoConversion()">
                    <option value="longitud" data-i18n="conversion.length">Longitud</option>
                    <option value="peso" data-i18n="conversion.weight">Peso</option>
                    <option value="temperatura" data-i18n="conversion.temperature">Temperatura</option>
                    <option value="volumen" data-i18n="conversion.volume">Volumen</option>
                    <option value="area" data-i18n="conversion.area">√Årea</option>
                    <option value="velocidad" data-i18n="conversion.speed">Velocidad</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="valor-original" data-i18n="conversion.value_to_convert">üî¢ Valor a convertir</label>
                <input type="number" id="valor-original" placeholder="1" value="1" step="any" oninput="convertirUnidades()">
            </div>
            
            <!-- Nueva fila con bot√≥n de intercambio -->
            <div class="conversion-row">
                <div class="form-group">
                    <label for="unidad-origen" data-i18n="conversion.from">De:</label>
                    <select id="unidad-origen" onchange="convertirUnidades()">
                        <!-- Se llena din√°micamente -->
                    </select>
                </div>
                <button class="swap-btn" onclick="intercambiarUnidades()" title="Intercambiar unidades" data-i18n-title="conversion.swap_units">‚áÑ</button>
                <div class="form-group">
                    <label for="unidad-destino" data-i18n="conversion.to">A:</label>
                    <select id="unidad-destino" onchange="convertirUnidades()">
                        <!-- Se llena din√°micamente -->
                    </select>
                </div>
            </div>
            
            <div class="result show" id="resultado-conversion">
                <h3 data-i18n="conversion.result">Resultado</h3>
                <div style="text-align: center; font-size: 1.5rem; padding: 20px; background: white; border-radius: 10px; margin: 15px 0;">
                    <span id="valor-convertido" style="color: #667eea; font-weight: 700;">1</span>
                    <span id="unidad-resultado" style="color: #4a5568; margin-left: 10px;">metros</span>
                </div>
                
                <div class="conversion-grid" id="conversiones-comunes">
                    <!-- Se llena din√°micamente -->
                </div>
            </div>
        </div>

        <div class="footer">
            <p data-i18n="footer.offline">üì± Aplicaci√≥n offline ‚Ä¢ Creado por Aurenox-Global</p>
        </div>
    </div>

    <script>
        // Sistema de internacionalizaci√≥n
        const translations = {
            es: {
                title: "üßÆ Finanza Plus",
                subtitle: "Herramientas financieras y de conversi√≥n",
                nav: {
                    mortgage: "üè† Hipoteca",
                    taxes: "üí∞ Impuestos",
                    tips: "üçΩÔ∏è Propinas",
                    conversion: "üìê Conversi√≥n"
                },
                mortgage: {
                    title: "Calculadora de Hipoteca",
                    house_price: "üíµ Precio de la casa",
                    house_price_placeholder: "300000",
                    down_payment: "üí≥ Enganche (%)",
                    interest_rate: "üìà Tasa de inter√©s (%)",
                    loan_years: "üìÖ A√±os del pr√©stamo",
                    years_15: "15 a√±os",
                    years_20: "20 a√±os",
                    years_30: "30 a√±os",
                    calculate: "Calcular Hipoteca",
                    summary: "Resumen de tu Hipoteca",
                    loan_amount: "Monto del pr√©stamo:",
                    monthly_payment: "Pago mensual:",
                    total_interest: "Total de intereses:",
                    total_payment: "Total a pagar:",
                    amortization_table: "Tabla de Amortizaci√≥n (Primeros 12 meses)",
                    month: "Mes",
                    payment: "Pago",
                    principal: "Principal",
                    interest: "Inter√©s",
                    balance: "Balance",
                    show_table: "Ver Tabla de Amortizaci√≥n",
                    hide_table: "Ocultar Tabla de Amortizaci√≥n"
                },
                taxes: {
                    title: "Calculadora de Impuestos",
                    gross_salary: "üíº Salario bruto anual",
                    marital_status: "üë´ Estado civil",
                    single: "Soltero",
                    married: "Casado",
                    head_of_household: "Jefe de familia",
                    dependents: "üë∂ Dependientes",
                    extra_deductions: "üìù Deducciones extra",
                    configure_rates: "‚öôÔ∏è Configurar Porcentajes de Impuestos",
                    federal_tax: "üèõÔ∏è Impuesto Federal (%)",
                    state_tax: "üè¢ Impuesto Estatal (%)",
                    social_security: "üë• Seguro Social (%)",
                    medicare: "üè• Medicare (%)",
                    unemployment: "üíº Seguro Desempleo (%)",
                    other_deductions: "üìã Otras Deducciones (%)",
                    basic_profile: "üìä Perfil B√°sico",
                    high_income: "üí∞ Ingresos Altos",
                    california: "üå¥ California",
                    calculate: "Calcular Impuestos",
                    detailed_calculation: "C√°lculo de Impuestos Detallado",
                    gross_annual_salary: "Salario bruto anual:",
                    total_deductions: "Deducciones totales:",
                    taxable_income: "Ingreso gravable:",
                    tax_breakdown: "üìä Desglose de Impuestos",
                    total_taxes: "Total de impuestos:",
                    net_annual_salary: "Salario neto anual:",
                    net_monthly_salary: "Salario neto mensual:",
                    net_weekly_salary: "Salario neto semanal:",
                    salary_distribution: "üìà Distribuci√≥n del Salario",
                    effective_tax_rate: "Tasa efectiva de impuestos:",
                    net_money: "üíö Dinero que te queda:",
                    total_taxes_chart: "üèõÔ∏è Impuestos totales:"
                },
                tips: {
                    title: "Calculadora de Propinas",
                    bill_total: "üßæ Total de la cuenta",
                    tip_percentage: "üí° Porcentaje de propina",
                    number_of_people: "üë• N√∫mero de personas",
                    calculate: "Calcular Propina",
                    calculation: "C√°lculo de Propina",
                    tip_amount: "Monto de propina:",
                    total_to_pay: "Total a pagar:",
                    per_person: "Por persona:",
                    tip_per_person: "Propina por persona:"
                },
                conversion: {
                    title: "Conversor de Unidades",
                    conversion_type: "üìè Tipo de conversi√≥n",
                    length: "Longitud",
                    weight: "Peso",
                    temperature: "Temperatura",
                    volume: "Volumen",
                    area: "√Årea",
                    speed: "Velocidad",
                    value_to_convert: "üî¢ Valor a convertir",
                    from: "De:",
                    to: "A:",
                    result: "Resultado",
                    swap_units: "Intercambiar unidades"
                },
                footer: {
                    offline: "üì± Aplicaci√≥n offline ‚Ä¢ Creado por Aurenox-Global"
                },
                units: {
                    // Longitud
                    metro: "metros",
                    kilometro: "kil√≥metros",
                    centimetro: "cent√≠metros",
                    milimetro: "mil√≠metros",
                    pulgada: "pulgadas",
                    pie: "pies",
                    yarda: "yardas",
                    milla: "millas",
                    // Peso
                    kilogramo: "kilogramos",
                    gramo: "gramos",
                    libra: "libras",
                    onza: "onzas",
                    tonelada: "toneladas",
                    piedra: "piedras",
                    // Volumen
                    litro: "litros",
                    mililitro: "mililitros",
                    galon: "galones",
                    cuarto: "cuartos",
                    pinta: "pintas",
                    taza: "tazas",
                    onza_liquida: "onzas l√≠quidas",
                    metro_cubico: "metros c√∫bicos",
                    // √Årea
                    metro_cuadrado: "metros cuadrados",
                    kilometro_cuadrado: "kil√≥metros cuadrados",
                    centimetro_cuadrado: "cent√≠metros cuadrados",
                    pie_cuadrado: "pies cuadrados",
                    pulgada_cuadrada: "pulgadas cuadradas",
                    acre: "acres",
                    hectarea: "hect√°reas",
                    // Velocidad
                    mps: "metros/segundo",
                    kmh: "km/hora",
                    mph: "millas/hora",
                    nudos: "nudos",
                    pps: "pies/segundo"
                }
            },
            en: {
                title: "üßÆ Finanza Plus",
                subtitle: "Financial and conversion tools",
                nav: {
                    mortgage: "üè† Mortgage",
                    taxes: "üí∞ Taxes",
                    tips: "üçΩÔ∏è Tips",
                    conversion: "üìê Conversion"
                },
                mortgage: {
                    title: "Mortgage Calculator",
                    house_price: "üíµ House price",
                    house_price_placeholder: "300000",
                    down_payment: "üí≥ Down payment (%)",
                    interest_rate: "üìà Interest rate (%)",
                    loan_years: "üìÖ Loan years",
                    years_15: "15 years",
                    years_20: "20 years",
                    years_30: "30 years",
                    calculate: "Calculate Mortgage",
                    summary: "Your Mortgage Summary",
                    loan_amount: "Loan amount:",
                    monthly_payment: "Monthly payment:",
                    total_interest: "Total interest:",
                    total_payment: "Total payment:",
                    amortization_table: "Amortization Table (First 12 months)",
                    month: "Month",
                    payment: "Payment",
                    principal: "Principal",
                    interest: "Interest",
                    balance: "Balance",
                    show_table: "Show Amortization Table",
                    hide_table: "Hide Amortization Table"
                },
                taxes: {
                    title: "Tax Calculator",
                    gross_salary: "üíº Annual gross salary",
                    marital_status: "üë´ Marital status",
                    single: "Single",
                    married: "Married",
                    head_of_household: "Head of household",
                    dependents: "üë∂ Dependents",
                    extra_deductions: "üìù Extra deductions",
                    configure_rates: "‚öôÔ∏è Configure Tax Percentages",
                    federal_tax: "üèõÔ∏è Federal Tax (%)",
                    state_tax: "üè¢ State Tax (%)",
                    social_security: "üë• Social Security (%)",
                    medicare: "üè• Medicare (%)",
                    unemployment: "üíº Unemployment Insurance (%)",
                    other_deductions: "üìã Other Deductions (%)",
                    basic_profile: "üìä Basic Profile",
                    high_income: "üí∞ High Income",
                    california: "üå¥ California",
                    calculate: "Calculate Taxes",
                    detailed_calculation: "Detailed Tax Calculation",
                    gross_annual_salary: "Annual gross salary:",
                    total_deductions: "Total deductions:",
                    taxable_income: "Taxable income:",
                    tax_breakdown: "üìä Tax Breakdown",
                    total_taxes: "Total taxes:",
                    net_annual_salary: "Annual net salary:",
                    net_monthly_salary: "Monthly net salary:",
                    net_weekly_salary: "Weekly net salary:",
                    salary_distribution: "üìà Salary Distribution",
                    effective_tax_rate: "Effective tax rate:",
                    net_money: "üíö Money you keep:",
                    total_taxes_chart: "üèõÔ∏è Total taxes:"
                },
                tips: {
                    title: "Tip Calculator",
                    bill_total: "üßæ Bill total",
                    tip_percentage: "üí° Tip percentage",
                    number_of_people: "üë• Number of people",
                    calculate: "Calculate Tip",
                    calculation: "Tip Calculation",
                    tip_amount: "Tip amount:",
                    total_to_pay: "Total to pay:",
                    per_person: "Per person:",
                    tip_per_person: "Tip per person:"
                },
                conversion: {
                    title: "Unit Converter",
                    conversion_type: "üìè Conversion type",
                    length: "Length",
                    weight: "Weight",
                    temperature: "Temperature",
                    volume: "Volume",
                    area: "Area",
                    speed: "Speed",
                    value_to_convert: "üî¢ Value to convert",
                    from: "From:",
                    to: "To:",
                    result: "Result",
                    swap_units: "Swap units"
                },
                footer: {
                    offline: "üì± Offline app ‚Ä¢ Creado por Aurenox-Global"
                },
                units: {
                    // Length
                    metro: "meters",
                    kilometro: "kilometers",
                    centimetro: "centimeters",
                    milimetro: "millimeters",
                    pulgada: "inches",
                    pie: "feet",
                    yarda: "yards",
                    milla: "miles",
                    // Weight
                    kilogramo: "kilograms",
                    gramo: "grams",
                    libra: "pounds",
                    onza: "ounces",
                    tonelada: "tons",
                    piedra: "stones",
                    // Volume
                    litro: "liters",
                    mililitro: "milliliters",
                    galon: "gallons",
                    cuarto: "quarts",
                    pinta: "pints",
                    taza: "cups",
                    onza_liquida: "fluid ounces",
                    metro_cubico: "cubic meters",
                    // Area
                    metro_cuadrado: "square meters",
                    kilometro_cuadrado: "square kilometers",
                    centimetro_cuadrado: "square centimeters",
                    pie_cuadrado: "square feet",
                    pulgada_cuadrada: "square inches",
                    acre: "acres",
                    hectarea: "hectares",
                    // Speed
                    mps: "meters/second",
                    kmh: "km/hour",
                    mph: "miles/hour",
                    nudos: "knots",
                    pps: "feet/second"
                }
            },
            de: {
                title: "üßÆ Finanza Plus",
                subtitle: "Finanz- und Umrechnungstools",
                nav: {
                    mortgage: "üè† Hypothek",
                    taxes: "üí∞ Steuern",
                    tips: "üçΩÔ∏è Trinkgeld",
                    conversion: "üìê Umrechnung"
                },
                mortgage: {
                    title: "Hypothekenrechner",
                    house_price: "üíµ Hauspreis",
                    house_price_placeholder: "300000",
                    down_payment: "üí≥ Anzahlung (%)",
                    interest_rate: "üìà Zinssatz (%)",
                    loan_years: "üìÖ Darlehensjahre",
                    years_15: "15 Jahre",
                    years_20: "20 Jahre",
                    years_30: "30 Jahre",
                    calculate: "Hypothek Berechnen",
                    summary: "Ihre Hypotheken-Zusammenfassung",
                    loan_amount: "Darlehensbetrag:",
                    monthly_payment: "Monatliche Rate:",
                    total_interest: "Gesamtzinsen:",
                    total_payment: "Gesamtzahlung:",
                    amortization_table: "Tilgungstabelle (Erste 12 Monate)",
                    month: "Monat",
                    payment: "Rate",
                    principal: "Tilgung",
                    interest: "Zinsen",
                    balance: "Saldo",
                    show_table: "Tilgungstabelle Anzeigen",
                    hide_table: "Tilgungstabelle Ausblenden"
                },
                taxes: {
                    title: "Steuerrechner",
                    gross_salary: "üíº Brutto-Jahresgehalt",
                    marital_status: "üë´ Familienstand",
                    single: "Ledig",
                    married: "Verheiratet",
                    head_of_household: "Haushaltsvorstand",
                    dependents: "üë∂ Unterhaltsberechtigte",
                    extra_deductions: "üìù Zus√§tzliche Abz√ºge",
                    configure_rates: "‚öôÔ∏è Steuers√§tze Konfigurieren",
                    federal_tax: "üèõÔ∏è Bundessteuer (%)",
                    state_tax: "üè¢ Landessteuer (%)",
                    social_security: "üë• Sozialversicherung (%)",
                    medicare: "üè• Krankenversicherung (%)",
                    unemployment: "üíº Arbeitslosenversicherung (%)",
                    other_deductions: "üìã Andere Abz√ºge (%)",
                    basic_profile: "üìä Basis-Profil",
                    high_income: "üí∞ Hohes Einkommen",
                    california: "üå¥ Kalifornien",
                    calculate: "Steuern Berechnen",
                    detailed_calculation: "Detaillierte Steuerberechnung",
                    gross_annual_salary: "Brutto-Jahresgehalt:",
                    total_deductions: "Gesamtabz√ºge:",
                    taxable_income: "Zu versteuerndes Einkommen:",
                    tax_breakdown: "üìä Steueraufschl√ºsselung",
                    total_taxes: "Gesamtsteuern:",
                    net_annual_salary: "Netto-Jahresgehalt:",
                    net_monthly_salary: "Netto-Monatsgehalt:",
                    net_weekly_salary: "Netto-Wochengehalt:",
                    salary_distribution: "üìà Gehaltsverteilung",
                    effective_tax_rate: "Effektiver Steuersatz:",
                    net_money: "üíö Geld das bleibt:",
                    total_taxes_chart: "üèõÔ∏è Gesamtsteuern:"
                },
                tips: {
                    title: "Trinkgeldrechner",
                    bill_total: "üßæ Rechnungsbetrag",
                    tip_percentage: "üí° Trinkgeld-Prozentsatz",
                    number_of_people: "üë• Anzahl Personen",
                    calculate: "Trinkgeld Berechnen",
                    calculation: "Trinkgeld-Berechnung",
                    tip_amount: "Trinkgeldbetrag:",
                    total_to_pay: "Gesamtbetrag:",
                    per_person: "Pro Person:",
                    tip_per_person: "Trinkgeld pro Person:"
                },
                conversion: {
                    title: "Einheitenumrechner",
                    conversion_type: "üìè Umrechnungstyp",
                    length: "L√§nge",
                    weight: "Gewicht",
                    temperature: "Temperatur",
                    volume: "Volumen",
                    area: "Fl√§che",
                    speed: "Geschwindigkeit",
                    value_to_convert: "üî¢ Umzurechnender Wert",
                    from: "Von:",
                    to: "Nach:",
                    result: "Ergebnis",
                    swap_units: "Einheiten tauschen"
                },
                footer: {
                    offline: "üì± Offline-App ‚Ä¢ Creado por Aurenox-Global"
                },
                units: {
                    // Length
                    metro: "Meter",
                    kilometro: "Kilometer",
                    centimetro: "Zentimeter",
                    milimetro: "Millimeter",
                    pulgada: "Zoll",
                    pie: "Fu√ü",
                    yarda: "Yard",
                    milla: "Meilen",
                    // Weight
                    kilogramo: "Kilogramm",
                    gramo: "Gramm",
                    libra: "Pfund",
                    onza: "Unzen",
                    tonelada: "Tonnen",
                    piedra: "Stones",
                    // Volume
                    litro: "Liter",
                    mililitro: "Milliliter",
                    galon: "Gallonen",
                    cuarto: "Quarts",
                    pinta: "Pints",
                    taza: "Tassen",
                    onza_liquida: "Fl√ºssigunzen",
                    metro_cubico: "Kubikmeter",
                    // Area
                    metro_cuadrado: "Quadratmeter",
                    kilometro_cuadrado: "Quadratkilometer",
                    centimetro_cuadrado: "Quadratzentimeter",
                    pie_cuadrado: "Quadratfu√ü",
                    pulgada_cuadrada: "Quadratzoll",
                    acre: "Acres",
                    hectarea: "Hektar",
                    // Speed
                    mps: "Meter/Sekunde",
                    kmh: "km/Stunde",
                    mph: "Meilen/Stunde",
                    nudos: "Knoten",
                    pps: "Fu√ü/Sekunde"
                }
            }
        };

        let currentLanguage = 'es';

        // Funci√≥n para cambiar idioma
        function cambiarIdioma(idioma) {
            currentLanguage = idioma;
            
            // Actualizar botones de idioma
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Actualizar atributo lang del documento
            document.documentElement.lang = idioma;
            
            // Aplicar traducciones
            aplicarTraducciones();
            
            // Guardar preferencia en localStorage
            localStorage.setItem('language', idioma);
            
            // Recalcular conversiones para actualizar unidades
            if (document.getElementById('calc-conversion').classList.contains('active')) {
                cambiarTipoConversion();
            }
        }

        // Funci√≥n para aplicar traducciones
        function aplicarTraducciones() {
            const t = translations[currentLanguage];
            
            // Traducir elementos con data-i18n
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = getNestedTranslation(t, key);
                if (translation) {
                    element.textContent = translation;
                }
            });
            
            // Traducir placeholders
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                const translation = getNestedTranslation(t, key);
                if (translation) {
                    element.placeholder = translation;
                }
            });

            // Traducir t√≠tulos (tooltips)
            document.querySelectorAll('[data-i18n-title]').forEach(element => {
                const key = element.getAttribute('data-i18n-title');
                const translation = getNestedTranslation(t, key);
                if (translation) {
                    element.title = translation;
                }
            });
            
            // Actualizar t√≠tulo de la p√°gina
            document.title = t.title;
        }

        // Funci√≥n auxiliar para obtener traducciones anidadas
        function getNestedTranslation(obj, path) {
            return path.split('.').reduce((current, key) => current && current[key], obj);
        }

        // Datos para conversiones
        const unidades = {
            longitud: {
                metro: 1,
                kilometro: 0.001,
                centimetro: 100,
                milimetro: 1000,
                pulgada: 39.3701,
                pie: 3.28084,
                yarda: 1.09361,
                milla: 0.000621371
            },
            peso: {
                kilogramo: 1,
                gramo: 1000,
                libra: 2.20462,
                onza: 35.274,
                tonelada: 0.001,
                piedra: 0.157473
            },
            temperatura: {
                celsius: { nombre: 'Celsius', simbolo: '¬∞C' },
                fahrenheit: { nombre: 'Fahrenheit', simbolo: '¬∞F' },
                kelvin: { nombre: 'Kelvin', simbolo: 'K' }
            },
            volumen: {
                litro: 1,
                mililitro: 1000,
                galon: 0.264172,
                cuarto: 1.05669,
                pinta: 2.11338,
                taza: 4.22675,
                onza_liquida: 33.814,
                metro_cubico: 0.001
            },
            area: {
                metro_cuadrado: 1,
                kilometro_cuadrado: 0.000001,
                centimetro_cuadrado: 10000,
                pie_cuadrado: 10.7639,
                pulgada_cuadrada: 1550,
                acre: 0.000247105,
                hectarea: 0.0001
            },
            velocidad: {
                mps: 1,
                kmh: 3.6,
                mph: 2.23694,
                nudos: 1.94384,
                pps: 3.28084
            }
        };

        // Navegaci√≥n entre calculadoras
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const calcType = this.dataset.calc;
                
                // Actualizar tabs activos
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Mostrar calculadora correspondiente
                document.querySelectorAll('.calculator').forEach(calc => calc.classList.remove('active'));
                document.getElementById(`calc-${calcType}`).classList.add('active');
                
                // Inicializar conversor si es necesario
                if (calcType === 'conversion') {
                    cambiarTipoConversion();
                }
            });
        });

        // Calculadora de Hipoteca
        function calcularHipoteca() {
            const precioCasa = parseFloat(document.getElementById('precio-casa').value) || 0;
            const porcentajeEnganche = parseFloat(document.getElementById('enganche').value) || 0;
            const tasaAnual = parseFloat(document.getElementById('tasa-interes').value) || 0;
            const a√±os = parseInt(document.getElementById('anos-prestamo').value) || 30;

            const enganche = precioCasa * (porcentajeEnganche / 100);
            const montoPrestamo = precioCasa - enganche;
            const tasaMensual = tasaAnual / 100 / 12;
            const numeroPageos = a√±os * 12;

            let pagoMensual = 0;
            if (tasaMensual > 0) {
                pagoMensual = montoPrestamo * (tasaMensual * Math.pow(1 + tasaMensual, numeroPageos)) / (Math.pow(1 + tasaMensual, numeroPageos) - 1);
            } else {
                pagoMensual = montoPrestamo / numeroPageos;
            }

            const totalPagos = pagoMensual * numeroPageos;
            const totalIntereses = totalPagos - montoPrestamo;

            // Mostrar resultados
            document.getElementById('monto-prestamo').textContent = formatearMoneda(montoPrestamo);
            document.getElementById('pago-mensual').textContent = formatearMoneda(pagoMensual);
            document.getElementById('total-intereses').textContent = formatearMoneda(totalIntereses);
            document.getElementById('total-pagar').textContent = formatearMoneda(totalPagos);
            
            document.getElementById('resultado-hipoteca').classList.add('show');
            scrollToResult('resultado-hipoteca');
            
            // Generar tabla de amortizaci√≥n
            generarTablaAmortizacion(montoPrestamo, pagoMensual, tasaMensual, numeroPageos);
        }

        function generarTablaAmortizacion(balance, pagoMensual, tasaMensual, numeroPageos) {
            const tbody = document.querySelector('#amortization-table tbody');
            tbody.innerHTML = '';
            
            let balanceActual = balance;
            const mesesMostrar = Math.min(12, numeroPageos); // Mostrar solo los primeros 12 meses
            
            for (let mes = 1; mes <= mesesMostrar; mes++) {
                const interesMensual = balanceActual * tasaMensual;
                const principalMensual = pagoMensual - interesMensual;
                balanceActual -= principalMensual;
                
                const fila = tbody.insertRow();
                fila.innerHTML = `
                    <td>${mes}</td>
                    <td>${formatearMoneda(pagoMensual)}</td>
                    <td>${formatearMoneda(principalMensual)}</td>
                    <td>${formatearMoneda(interesMensual)}</td>
                    <td>${formatearMoneda(balanceActual)}</td>
                `;
            }
        }

        function toggleAmortization() {
            const tabla = document.getElementById('tabla-amortizacion');
            const btn = document.getElementById('btn-amortization');
            const t = translations[currentLanguage];
            
            if (tabla.style.display === 'none') {
                tabla.style.display = 'block';
                btn.textContent = t.mortgage.hide_table;
            } else {
                tabla.style.display = 'none';
                btn.textContent = t.mortgage.show_table;
            }
        }

        // Calculadora de Impuestos (mejorada con porcentajes personalizables)
        function calcularImpuestos() {
            const salarioBruto = parseFloat(document.getElementById('salario-bruto').value) || 0;
            const estadoCivil = document.getElementById('estado-civil').value;
            const dependientes = parseInt(document.getElementById('dependientes').value) || 0;
            const deduccionesExtra = parseFloat(document.getElementById('deducciones').value) || 0;
            
            // Obtener porcentajes personalizados
            const tasaFederal = parseFloat(document.getElementById('tasa-federal').value) || 0;
            const tasaEstatal = parseFloat(document.getElementById('tasa-estatal').value) || 0;
            const tasaSeguroSocial = parseFloat(document.getElementById('tasa-seguro-social').value) || 0;
            const tasaMedicare = parseFloat(document.getElementById('tasa-medicare').value) || 0;
            const tasaDesempleo = parseFloat(document.getElementById('tasa-desempleo').value) || 0;
            const tasaOtrasDeducciones = parseFloat(document.getElementById('otras-deducciones').value) || 0;

            // Deducciones est√°ndar 2024
            let deduccionEstandar = 0;
            switch (estadoCivil) {
                case 'soltero':
                    deduccionEstandar = 14600;
                    break;
                case 'casado':
                    deduccionEstandar = 29200;
                    break;
                case 'jefe-familia':
                    deduccionEstandar = 21900;
                    break;
            }

            // Deducciones por dependientes (aproximado)
            const deduccionDependientes = dependientes * 4000;
            const deduccionesTotales = deduccionEstandar + deduccionesExtra + deduccionDependientes;
            const ingresoGravable = Math.max(0, salarioBruto - deduccionesTotales);
            
            // C√°lculos de impuestos con porcentajes personalizados
            const impuestoFederal = ingresoGravable * (tasaFederal / 100);
            const impuestoEstatal = ingresoGravable * (tasaEstatal / 100);
            const seguroSocial = salarioBruto * (tasaSeguroSocial / 100);
            const medicare = salarioBruto * (tasaMedicare / 100);
            const seguroDesempleo = salarioBruto * (tasaDesempleo / 100);
            const otrasDeducciones = salarioBruto * (tasaOtrasDeducciones / 100);
            
            const totalImpuestos = impuestoFederal + impuestoEstatal + seguroSocial + medicare + seguroDesempleo + otrasDeducciones;
            const salarioNeto = salarioBruto - totalImpuestos;
            const tasaEfectiva = salarioBruto > 0 ? (totalImpuestos / salarioBruto * 100) : 0;

            // Mostrar resultados
            document.getElementById('salario-bruto-display').textContent = formatearMoneda(salarioBruto);
            document.getElementById('deducciones-totales').textContent = formatearMoneda(deduccionesTotales);
            document.getElementById('ingreso-gravable').textContent = formatearMoneda(ingresoGravable);
            document.getElementById('impuesto-federal').textContent = formatearMoneda(impuestoFederal);
            document.getElementById('impuesto-estatal').textContent = formatearMoneda(impuestoEstatal);
            document.getElementById('seguro-social').textContent = formatearMoneda(seguroSocial);
            document.getElementById('medicare').textContent = formatearMoneda(medicare);
            document.getElementById('seguro-desempleo').textContent = formatearMoneda(seguroDesempleo);
            document.getElementById('otras-deducciones-monto').textContent = formatearMoneda(otrasDeducciones);
            document.getElementById('total-impuestos').textContent = formatearMoneda(totalImpuestos);
            document.getElementById('salario-neto').textContent = formatearMoneda(salarioNeto);
            document.getElementById('salario-mensual').textContent = formatearMoneda(salarioNeto / 12);
            document.getElementById('salario-semanal').textContent = formatearMoneda(salarioNeto / 52);
            document.getElementById('tasa-efectiva').textContent = tasaEfectiva.toFixed(2) + '%';
            
            // Actualizar displays de tasas
            document.getElementById('tasa-federal-display').textContent = tasaFederal;
            document.getElementById('tasa-estatal-display').textContent = tasaEstatal;
            document.getElementById('tasa-ss-display').textContent = tasaSeguroSocial;
            document.getElementById('tasa-medicare-display').textContent = tasaMedicare;
            document.getElementById('tasa-desempleo-display').textContent = tasaDesempleo;
            document.getElementById('tasa-otras-display').textContent = tasaOtrasDeducciones;
            
            // Generar gr√°fico visual
            generarGraficoImpuestos(salarioNeto, totalImpuestos, salarioBruto);
            
            document.getElementById('resultado-impuestos').classList.add('show');
            scrollToResult('resultado-impuestos');
        }

        function generarGraficoImpuestos(salarioNeto, totalImpuestos, salarioBruto) {
            const grafico = document.getElementById('grafico-impuestos');
            const porcentajeNeto = (salarioNeto / salarioBruto * 100);
            const porcentajeImpuestos = (totalImpuestos / salarioBruto * 100);
            const t = translations[currentLanguage];
            
            grafico.innerHTML = `
                <div style="display: flex; height: 30px; border-radius: 15px; overflow: hidden; margin: 10px 0;">
                    <div style="background: linear-gradient(135deg, #48bb78, #38a169); width: ${porcentajeNeto}%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem;">
                        ${porcentajeNeto.toFixed(1)}% ${currentLanguage === 'es' ? 'Neto' : currentLanguage === 'en' ? 'Net' : 'Netto'}
                    </div>
                    <div style="background: linear-gradient(135deg, #f56565, #e53e3e); width: ${porcentajeImpuestos}%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem;">
                        ${porcentajeImpuestos.toFixed(1)}% ${currentLanguage === 'es' ? 'Impuestos' : currentLanguage === 'en' ? 'Taxes' : 'Steuern'}
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #4a5568;">
                    <span>${t.taxes.net_money} ${formatearMoneda(salarioNeto)}</span>
                    <span>${t.taxes.total_taxes_chart} ${formatearMoneda(totalImpuestos)}</span>
                </div>
            `;
        }

        function cargarPerfilImpuestos(perfil) {
            switch(perfil) {
                case 'basico':
                    document.getElementById('tasa-federal').value = 12;
                    document.getElementById('tasa-estatal').value = 3;
                    document.getElementById('tasa-seguro-social').value = 6.2;
                    document.getElementById('tasa-medicare').value = 1.45;
                    document.getElementById('tasa-desempleo').value = 0.5;
                    document.getElementById('otras-deducciones').value = 0;
                    break;
                case 'alto':
                    document.getElementById('tasa-federal').value = 32;
                    document.getElementById('tasa-estatal').value = 8;
                    document.getElementById('tasa-seguro-social').value = 6.2;
                    document.getElementById('tasa-medicare').value = 2.35; // Incluye Medicare adicional
                    document.getElementById('tasa-desempleo').value = 0.6;
                    document.getElementById('otras-deducciones').value = 1;
                    break;
                case 'california':
                    document.getElementById('tasa-federal').value = 24;
                    document.getElementById('tasa-estatal').value = 9.3;
                    document.getElementById('tasa-seguro-social').value = 6.2;
                    document.getElementById('tasa-medicare').value = 1.45;
                    document.getElementById('tasa-desempleo').value = 1.1;
                    document.getElementById('otras-deducciones').value = 0.5;
                    break;
            }
            
            // Recalcular autom√°ticamente
            if (document.getElementById('salario-bruto').value) {
                calcularImpuestos();
            }
        }

        // Auto-calcular cuando cambian los porcentajes
        ['tasa-federal', 'tasa-estatal', 'tasa-seguro-social', 'tasa-medicare', 'tasa-desempleo', 'otras-deducciones'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                if (document.getElementById('salario-bruto').value) {
                    calcularImpuestos();
                }
            });
        });

        // Calculadora de Propinas
        function setPropina(porcentaje) {
            document.getElementById('porcentaje-propina').value = porcentaje;
            
            // Actualizar estilos de botones
            document.querySelectorAll('.tip-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            calcularPropina();
        }

        function calcularPropina() {
            const totalCuenta = parseFloat(document.getElementById('total-cuenta').value) || 0;
            const porcentajePropina = parseFloat(document.getElementById('porcentaje-propina').value) || 0;
            const numPersonas = parseInt(document.getElementById('num-personas').value) || 1;

            const montoPropina = totalCuenta * (porcentajePropina / 100);
            const totalConPropina = totalCuenta + montoPropina;
            const porPersona = totalConPropina / numPersonas;
            const propinaPersona = montoPropina / numPersonas;

            document.getElementById('monto-propina').textContent = formatearMoneda(montoPropina);
            document.getElementById('total-con-propina').textContent = formatearMoneda(totalConPropina);
            document.getElementById('por-persona').textContent = formatearMoneda(porPersona);
            document.getElementById('propina-persona').textContent = formatearMoneda(propinaPersona);
            
            document.getElementById('resultado-propina').classList.add('show');
            scrollToResult('resultado-propina');
        }

        // Auto-calcular propina cuando cambian los valores
        document.getElementById('total-cuenta').addEventListener('input', calcularPropina);
        document.getElementById('porcentaje-propina').addEventListener('input', calcularPropina);
        document.getElementById('num-personas').addEventListener('input', calcularPropina);

        // Calculadora de Conversi√≥n
        function cambiarTipoConversion() {
            const tipo = document.getElementById('tipo-conversion').value;
            const selectOrigen = document.getElementById('unidad-origen');
            const selectDestino = document.getElementById('unidad-destino');
            const t = translations[currentLanguage];
            
            selectOrigen.innerHTML = '';
            selectDestino.innerHTML = '';

            if (tipo === 'temperatura') {
                Object.keys(unidades.temperatura).forEach(unidad => {
                    const info = unidades.temperatura[unidad];
                    const option1 = new Option(info.nombre, unidad);
                    const option2 = new Option(info.nombre, unidad);
                    selectOrigen.add(option1);
                    selectDestino.add(option2);
                });
                selectDestino.selectedIndex = 1;
            } else {
                Object.keys(unidades[tipo]).forEach(unidad => {
                    const nombreUnidad = t.units[unidad] || unidad.replace('_', ' ');
                    const option1 = new Option(nombreUnidad, unidad);
                    const option2 = new Option(nombreUnidad, unidad);
                    selectOrigen.add(option1);
                    selectDestino.add(option2);
                });
                selectDestino.selectedIndex = 1;
            }
            
            convertirUnidades();
        }

        // Nueva funci√≥n para intercambiar unidades
        function intercambiarUnidades() {
            const selectOrigen = document.getElementById('unidad-origen');
            const selectDestino = document.getElementById('unidad-destino');
            
            // Guardar valores actuales
            const origenValor = selectOrigen.value;
            const destinoValor = selectDestino.value;
            
            // Intercambiar valores
            selectOrigen.value = destinoValor;
            selectDestino.value = origenValor;
            
            // A√±adir efecto de vibraci√≥n si est√° disponible
            if ('vibrate' in navigator) {
                navigator.vibrate(100);
            }
            
            // Recalcular conversi√≥n
            convertirUnidades();
        }

        function convertirUnidades() {
            const valor = parseFloat(document.getElementById('valor-original').value) || 0;
            const tipo = document.getElementById('tipo-conversion').value;
            const unidadOrigen = document.getElementById('unidad-origen').value;
            const unidadDestino = document.getElementById('unidad-destino').value;
            const t = translations[currentLanguage];
            
            let resultado = 0;
            
            if (tipo === 'temperatura') {
                resultado = convertirTemperatura(valor, unidadOrigen, unidadDestino);
            } else {
                const factorOrigen = unidades[tipo][unidadOrigen];
                const factorDestino = unidades[tipo][unidadDestino];
                resultado = (valor / factorOrigen) * factorDestino;
            }
            
            document.getElementById('valor-convertido').textContent = resultado.toFixed(4);
            
            const unidadTexto = tipo === 'temperatura' 
                ? unidades.temperatura[unidadDestino].simbolo 
                : (t.units[unidadDestino] || unidadDestino.replace('_', ' '));
            document.getElementById('unidad-resultado').textContent = unidadTexto;
            
            mostrarConversionesComunes(valor, tipo, unidadOrigen);
        }

        function convertirTemperatura(valor, origen, destino) {
            let celsius = valor;
            
            // Convertir a Celsius primero
            if (origen === 'fahrenheit') {
                celsius = (valor - 32) * 5/9;
            } else if (origen === 'kelvin') {
                celsius = valor - 273.15;
            }
            
            // Convertir de Celsius al destino
            if (destino === 'fahrenheit') {
                return celsius * 9/5 + 32;
            } else if (destino === 'kelvin') {
                return celsius + 273.15;
            }
            
            return celsius;
        }

        function mostrarConversionesComunes(valor, tipo, unidadOrigen) {
            const grid = document.getElementById('conversiones-comunes');
            const t = translations[currentLanguage];
            grid.innerHTML = '';
            
            if (tipo === 'temperatura') {
                Object.keys(unidades.temperatura).forEach(unidad => {
                    if (unidad !== unidadOrigen) {
                        const resultado = convertirTemperatura(valor, unidadOrigen, unidad);
                        const info = unidades.temperatura[unidad];
                        
                        const item = document.createElement('div');
                        item.className = 'conversion-item';
                        item.innerHTML = `
                            <div class="conversion-value">${resultado.toFixed(2)}</div>
                            <div class="conversion-unit">${info.simbolo}</div>
                        `;
                        grid.appendChild(item);
                    }
                });
            } else {
                const factorOrigen = unidades[tipo][unidadOrigen];
                const unidadesComunes = Object.keys(unidades[tipo]).slice(0, 6);
                
                unidadesComunes.forEach(unidad => {
                    if (unidad !== unidadOrigen) {
                        const factorDestino = unidades[tipo][unidad];
                        const resultado = (valor / factorOrigen) * factorDestino;
                        
                        const item = document.createElement('div');
                        item.className = 'conversion-item';
                        item.innerHTML = `
                            <div class="conversion-value">${resultado.toFixed(4)}</div>
                            <div class="conversion-unit">${t.units[unidad] || unidad.replace('_', ' ')}</div>
                        `;
                        grid.appendChild(item);
                    }
                });
            }
        }

        // Funci√≥n de formateo de moneda
        function formatearMoneda(cantidad) {
            const locale = currentLanguage === 'de' ? 'de-DE' : currentLanguage === 'en' ? 'en-US' : 'es-US';
            const currency = currentLanguage === 'de' ? 'EUR' : 'USD';
            
            return new Intl.NumberFormat(locale, {
                style: 'currency',
                currency: currency
            }).format(cantidad);
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            // Cargar idioma guardado
            const savedLanguage = localStorage.getItem('language') || 'es';
            if (savedLanguage !== 'es') {
                // Actualizar bot√≥n activo
                document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[onclick="cambiarIdioma('${savedLanguage}')"]`).classList.add('active');
                currentLanguage = savedLanguage;
                document.documentElement.lang = savedLanguage;
            }
            
            aplicarTraducciones();
            cambiarTipoConversion();
            calcularPropina();
            inicializarScrollMobile();
        });

        // Permitir solo n√∫meros en inputs num√©ricos
        document.querySelectorAll('input[type="number"]').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (!/[\d.-]/.test(e.key) && !['Backspace', 'Delete', 'Tab', 'Enter', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
                    e.preventDefault();
                }
            });
        });

        // Prevenir valores negativos donde no tenga sentido
        document.querySelectorAll('#precio-casa, #total-cuenta, #valor-original').forEach(input => {
            input.addEventListener('input', function() {
                if (this.value < 0) this.value = 0;
            });
        });

        // Animaci√≥n suave al cambiar de calculadora
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Peque√±o haptic feedback en dispositivos m√≥viles
                if ('vibrate' in navigator) {
                    navigator.vibrate(50);
                }
            });
        });

        // Soporte para instalaci√≥n como PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            deferredPrompt = e;
        });

        // Optimizaci√≥n para pantallas peque√±as y scroll
        function ajustarPantalla() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            // Asegurar que el scroll funcione en m√≥viles
            document.body.style.minHeight = `${window.innerHeight}px`;
        }

        // Manejar scroll suave en dispositivos t√°ctiles
        function inicializarScrollMobile() {
            // Detectar si es un dispositivo m√≥vil
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // Habilitar scroll suave para iOS
                document.body.style.webkitOverflowScrolling = 'touch';
                document.body.style.overflowY = 'auto';
                
                // Prevenir zoom en inputs en iOS
                const inputs = document.querySelectorAll('input, select');
                inputs.forEach(input => {
                    input.addEventListener('focus', function() {
                        if (window.innerWidth < 768) {
                            setTimeout(() => {
                                this.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }, 300);
                        }
                    });
                });
            }
        }

        // Scroll autom√°tico al mostrar resultados
        function scrollToResult(resultId) {
            setTimeout(() => {
                const resultElement = document.getElementById(resultId);
                if (resultElement && resultElement.classList.contains('show')) {
                    resultElement.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'nearest',
                        inline: 'start'
                    });
                }
            }, 300);
        }

        window.addEventListener('resize', ajustarPantalla);
        window.addEventListener('orientationchange', ajustarPantalla);
        ajustarPantalla();
    </script>
</body>
</html>
